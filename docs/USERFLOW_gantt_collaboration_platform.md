# USER FLOW: 부서 협업 간트차트 플랫폼

## 1. 전체 사용자 여정 맵

```
┌─────────────┐
│   방문자    │
└──────┬──────┘
       │
       ▼
┌─────────────────────────┐
│  랜딩 페이지             │
│  - 서비스 소개           │
│  - 주요 기능 하이라이트   │
│  - 회원가입/로그인 버튼   │
└──────┬──────────────────┘
       │
    ┌──┴──┐
    │ 선택 │
    └──┬──┘
       │
   ┌───┴──────┐
   ▼          ▼
[회원가입]  [로그인]
   │          │
   └────┬─────┘
        ▼
┌─────────────────┐
│  대시보드 홈     │
│  - 프로젝트 카드  │
│  - 통계 위젯     │
│  - 최근 활동     │
└────────┬────────┘
         │
    ┌────┴────┐
    │ 프로젝트 │
    │   선택   │
    └────┬────┘
         ▼
┌──────────────────────┐
│  프로젝트 상세 페이지 │
│  - 태스크 리스트      │
│  - 간트차트 뷰        │
│  - 팀원 목록          │
└──────┬───────────────┘
       │
   ┌───┴────┐
   ▼        ▼
[태스크   [간트차트
 관리]     조작]
   │        │
   └───┬────┘
       ▼
   [실시간
    협업]
```

---

## 2. 핵심 사용자 플로우

### 2.1 회원가입 및 조직 생성 플로우

```
START → 이메일 입력 → 비밀번호 설정 → 이름 입력 → 조직명 입력 → 확인 이메일 발송 → 이메일 인증 → 대시보드 이동 → END
```

**화면별 상세 플로우**

#### **Step 1: 회원가입 페이지 (/register)**
```
┌────────────────────────────────┐
│      간트차트 플랫폼 로고       │
├────────────────────────────────┤
│                                │
│   회원가입                      │
│                                │
│   📧 이메일                    │
│   [________________]           │
│                                │
│   🔒 비밀번호 (8자 이상)       │
│   [________________]           │
│                                │
│   👤 이름                      │
│   [________________]           │
│                                │
│   🏢 조직명 (새로 만들기)      │
│   [________________]           │
│                                │
│   [ 회원가입 ]                 │
│                                │
│   이미 계정이 있으신가요?       │
│   로그인하기 →                 │
└────────────────────────────────┘
```

**입력 검증**
- 이메일: 유효한 형식 + 중복 체크
- 비밀번호: 최소 8자, 영문+숫자 조합
- 조직명: 2~50자, 중복 허용

**액션**
1. 사용자가 "회원가입" 버튼 클릭
2. 유효성 검사 실행
3. Supabase Auth에 사용자 등록
4. organizations 테이블에 조직 생성
5. users 테이블에 사용자 정보 저장 (role: 'admin')
6. 확인 이메일 발송
7. "이메일을 확인해주세요" 안내 페이지 표시

**에러 처리**
- 이메일 중복: "이미 사용 중인 이메일입니다"
- 네트워크 오류: "잠시 후 다시 시도해주세요"

---

#### **Step 2: 이메일 인증**
```
┌────────────────────────────────┐
│      📬 이메일을 확인하세요     │
├────────────────────────────────┤
│                                │
│  test@example.com으로          │
│  인증 이메일을 발송했습니다.    │
│                                │
│  이메일의 링크를 클릭하여       │
│  계정을 활성화하세요.           │
│                                │
│  [ 이메일 재발송 ]             │
│                                │
└────────────────────────────────┘
```

**이메일 내용**
```
제목: [간트차트 플랫폼] 이메일 인증

안녕하세요, [사용자명]님!

아래 버튼을 클릭하여 계정을 활성화하세요:

[계정 활성화하기]  ← 링크: /auth/confirm?token=xxx

링크가 작동하지 않으면 아래 URL을 복사하세요:
https://yourapp.com/auth/confirm?token=xxx

감사합니다.
```

**액션**
1. 사용자가 이메일 링크 클릭
2. 토큰 검증
3. 계정 활성화
4. 자동 로그인 → 대시보드 이동

---

### 2.2 로그인 플로우

```
START → 이메일/비밀번호 입력 → 인증 → 대시보드 이동 → END
```

#### **로그인 페이지 (/login)**
```
┌────────────────────────────────┐
│      간트차트 플랫폼 로고       │
├────────────────────────────────┤
│                                │
│   로그인                        │
│                                │
│   📧 이메일                    │
│   [________________]           │
│                                │
│   🔒 비밀번호                  │
│   [________________]           │
│                                │
│   [ 로그인 ]                   │
│                                │
│   비밀번호를 잊으셨나요?        │
│   재설정하기 →                 │
│                                │
│   계정이 없으신가요?            │
│   회원가입하기 →               │
└────────────────────────────────┘
```

**액션**
1. 이메일/비밀번호 입력
2. Supabase Auth 인증 요청
3. 성공 시: JWT 토큰 발급 + 세션 생성
4. users 테이블에서 조직 정보 조회
5. /dashboard로 리다이렉트

**에러 처리**
- 잘못된 인증 정보: "이메일 또는 비밀번호가 일치하지 않습니다"
- 이메일 미인증: "이메일 인증이 필요합니다. 이메일을 확인해주세요"

---

### 2.3 대시보드 플로우

#### **대시보드 메인 (/dashboard)**
```
┌──────────────────────────────────────────────────────────────────┐
│  ☰ 메뉴                  간트차트 플랫폼              👤 사용자명  │
├──────────────────────────────────────────────────────────────────┤
│                                                                  │
│  📊 대시보드                                      [ + 새 프로젝트 ]│
│                                                                  │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │ 전체 프로젝트    │  │ 진행 중          │  │ 이번 주 마감     │ │
│  │      12         │  │      8          │  │      15         │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
│                                                                  │
│  내 프로젝트                                      [ 전체 보기 → ] │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │ 🟣 신제품 출시 프로젝트          진행률: ████████░░ 75%    │  │
│  │    개발팀, 디자인팀, 마케팅팀                             │  │
│  │    📅 2026-01-01 ~ 2026-03-31                            │  │
│  └──────────────────────────────────────────────────────────┘  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │ 🔵 웹사이트 리뉴얼               진행률: ████░░░░░░ 40%    │  │
│  │    개발팀, 디자인팀                                       │  │
│  │    📅 2026-01-15 ~ 2026-02-28                            │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
│  최근 활동                                                       │
│  • 김철수님이 "백엔드 API 개발" 태스크를 완료했습니다 (2분 전)   │
│  • 이영희님이 "UI 디자인" 태스크를 시작했습니다 (15분 전)       │
│  • 박민수님이 댓글을 남겼습니다: "디자인 시안 확인..." (1시간 전)│
│                                                                  │
└──────────────────────────────────────────────────────────────────┘
```

**주요 액션**
1. **프로젝트 카드 클릭** → 프로젝트 상세 페이지로 이동
2. **+ 새 프로젝트 버튼** → 프로젝트 생성 모달 표시
3. **최근 활동 클릭** → 해당 태스크로 이동

---

### 2.4 프로젝트 생성 플로우

```
대시보드 → "+ 새 프로젝트" 클릭 → 모달 표시 → 정보 입력 → 저장 → 프로젝트 상세로 이동
```

#### **프로젝트 생성 모달**
```
┌────────────────────────────────────────┐
│  새 프로젝트                        ✕  │
├────────────────────────────────────────┤
│                                        │
│  프로젝트명 *                          │
│  [________________________]            │
│                                        │
│  설명                                  │
│  [________________________]            │
│  [________________________]            │
│                                        │
│  기간 *                                │
│  [2026-01-13] ~ [2026-03-31]           │
│                                        │
│  색상 *                                │
│  ⚫ 🔵 🟢 🟡 🔴 🟣 ⚪                   │
│                                        │
│  [ 취소 ]            [ 프로젝트 생성 ] │
└────────────────────────────────────────┘
```

**입력 필드**
- 프로젝트명: 필수, 1~200자
- 설명: 선택, 최대 1000자
- 시작일/종료일: 필수, 종료일 >= 시작일
- 색상: 필수, 7가지 프리셋 중 선택

**액션**
1. "프로젝트 생성" 버튼 클릭
2. 유효성 검사
3. POST /api/projects 요청
4. 성공 시: 모달 닫기 + /projects/[new-id] 페이지로 이동
5. 알림 표시: "프로젝트가 생성되었습니다"

---

### 2.5 프로젝트 상세 및 간트차트 플로우

#### **프로젝트 상세 페이지 (/projects/[id])**
```
┌──────────────────────────────────────────────────────────────────┐
│  ← 대시보드              신제품 출시 프로젝트            👤 김팀장  │
├──────────────────────────────────────────────────────────────────┤
│  [ 📋 리스트 ]  [ 📊 간트차트 ]  [ 📅 캘린더 ]  [ ⚙️ 설정 ]     │
├──────────────────────────────────────────────────────────────────┤
│                                                                  │
│  좌측 패널 (30%)               │  우측 패널 (70%)                 │
│  ┌──────────────────────────┐  │  ┌──────────────────────────┐ │
│  │ 🔍 검색...               │  │  │ 간트차트 타임라인         │ │
│  │ [ + 태스크 추가 ]        │  │  │                          │ │
│  ├──────────────────────────┤  │  │ 1월 ─────────────────── │ │
│  │                          │  │  │ 13 14 15 16 17 18 19     │ │
│  │ ✅ 기획 단계 (완료)      │  │  │ ───────────────────────  │ │
│  │   └ 요구사항 정의        │  │  │ [요구사항] ████          │ │
│  │   └ 화면 설계            │  │  │ [화면설계]    ████       │ │
│  │                          │  │  │                          │ │
│  │ 🔄 개발 단계 (진행중)    │  │  │ [백엔드]      ████████   │ │
│  │   └ 백엔드 API           │  │  │ [프론트]        ████████ │ │
│  │      담당: 박개발        │  │  │ [통합테스트]      ████   │ │
│  │      75% ████████░░      │  │  │                          │ │
│  │   └ 프론트엔드 개발      │  │  │ 오늘 ↓                   │ │
│  │      담당: 이디자인      │  │  │                          │ │
│  │      40% ████░░░░░░      │  │  └──────────────────────────┘ │
│  │   └ 통합 테스트          │  │                                │
│  │      담당: 김QA          │  │  [ 🔍 확대 ] [ 🔎 축소 ]       │
│  │      0% ░░░░░░░░░░       │  │  [ 일간 | 주간 | 월간 ]       │
│  │                          │  │                                │
│  └──────────────────────────┘  │                                │
└──────────────────────────────────────────────────────────────────┘
```

**주요 상호작용**

1. **태스크 카드 클릭**
   - 우측에 상세 정보 패널 슬라이드인
   - 댓글 섹션, 첨부파일, 활동 로그 표시

2. **간트차트 바 드래그**
   - 수평 드래그: 일정 조정 (시작일/종료일 변경)
   - 우측 핸들 드래그: 기간 연장/축소
   - 실시간으로 좌측 리스트도 업데이트

3. **의존성 연결**
   - 태스크 A 우측 핸들 → 태스크 B로 드래그
   - 화살표 생성 (A 완료 후 B 시작)

4. **진행률 업데이트**
   - 태스크 카드의 진행률 바 클릭
   - 슬라이더로 0~100% 조정
   - 간트차트에 즉시 반영

---

### 2.6 태스크 생성 플로우

```
프로젝트 페이지 → "+ 태스크 추가" → 모달 표시 → 정보 입력 → 저장 → 리스트 갱신
```

#### **태스크 생성 모달**
```
┌────────────────────────────────────────┐
│  새 태스크                          ✕  │
├────────────────────────────────────────┤
│                                        │
│  태스크명 *                            │
│  [________________________]            │
│                                        │
│  설명                                  │
│  [________________________]            │
│                                        │
│  담당자 *                              │
│  [ 선택하세요 ▼ ]                      │
│    └ 김철수 (개발팀)                   │
│    └ 이영희 (디자인팀)                 │
│    └ 박민수 (마케팅팀)                 │
│                                        │
│  기간 *                                │
│  [2026-01-15] ~ [2026-01-20]           │
│                                        │
│  우선순위                              │
│  ○ 낮음  ◉ 보통  ○ 높음  ○ 긴급       │
│                                        │
│  선행 태스크 (선택)                    │
│  [ 선택하세요 ▼ ]                      │
│                                        │
│  [ 취소 ]              [ 태스크 생성 ] │
└────────────────────────────────────────┘
```

**액션 시퀀스**
1. 사용자가 정보 입력
2. "태스크 생성" 클릭
3. POST /api/tasks 요청
4. 성공 시:
   - 좌측 리스트에 새 태스크 추가
   - 간트차트에 새 바 표시
   - 담당자에게 이메일 알림 발송
5. 모달 닫기

---

### 2.7 실시간 협업 플로우

#### **동시 편집 시나리오**

**사용자 A (김팀장)**: 태스크 일정 변경
```
1. 간트차트에서 "백엔드 API" 바를 드래그
2. 1월 15일 → 1월 18일로 변경
3. 낙관적 업데이트: UI 즉시 변경
4. 서버에 PATCH 요청
5. WebSocket으로 변경사항 브로드캐스트
```

**사용자 B (박개발)**: 동일 프로젝트 보는 중
```
1. WebSocket 메시지 수신
2. 자동으로 간트차트 갱신
3. 알림 표시: "김팀장님이 '백엔드 API' 일정을 변경했습니다"
```

#### **현재 편집 중 표시 (Presence)**
```
┌──────────────────────────────┐
│ 백엔드 API 개발               │
│ 담당: 박개발                  │
│ 50% ██████░░░░               │
│                              │
│ 👤 김팀장님이 편집 중...      │ ← Presence 표시
└──────────────────────────────┘
```

---

### 2.8 댓글 및 멘션 플로우

#### **댓글 작성**
```
태스크 클릭 → 상세 패널 열림 → 댓글 섹션 스크롤 → 댓글 입력 → 전송
```

**댓글 패널**
```
┌────────────────────────────────────────┐
│  백엔드 API 개발                    ✕  │
├────────────────────────────────────────┤
│  ... (태스크 정보) ...                 │
├────────────────────────────────────────┤
│  💬 댓글 (3)                           │
│                                        │
│  김팀장 • 2시간 전                      │
│  @박개발 API 스펙 확인 부탁드립니다.    │
│                                        │
│  박개발 • 1시간 전                      │
│  넵, 확인했습니다. 내일 완료 예정!      │
│                                        │
│  이영희 • 30분 전                       │
│  디자인 시안에 맞춰서 진행 부탁드려요.  │
│                                        │
│  ─────────────────────────────────────  │
│  댓글 작성...                          │
│  @ 멘션하려면 @를 입력하세요            │
│  [________________________]            │
│                        [ 전송 ]        │
└────────────────────────────────────────┘
```

**멘션 자동완성**
```
사용자가 "@" 입력 시:
┌──────────────────┐
│ @박개발          │
│ @이영희          │
│ @김QA            │
└──────────────────┘
```

**액션**
1. 댓글 작성 후 "전송" 클릭
2. POST /api/tasks/[id]/comments
3. 멘션된 사용자에게 인앱 알림 + 이메일 발송
4. 댓글 목록에 즉시 추가 (WebSocket)

---

### 2.9 알림 플로우

#### **알림 센터 UI**
```
┌────────────────────────────────────────┐
│  🔔 알림 (5)                        ✕  │
├────────────────────────────────────────┤
│                                        │
│  🔴 김팀장님이 회원가입 화면 디자인에   │
│     회원님을 멘션했습니다.              │
│     "디자인 시안 확인 부탁드립니다"     │
│     2분 전 • [ 보기 ]                  │
│                                        │
│  🟡 신제품 출시 프로젝트 - 백엔드 API   │
│     마감일이 3일 남았습니다.            │
│     1시간 전 • [ 보기 ]                │
│                                        │
│  🟢 박개발님이 '백엔드 API 개발'을      │
│     완료했습니다.                       │
│     2시간 전 • [ 보기 ]                │
│                                        │
│  [ 모두 읽음 처리 ]                    │
└────────────────────────────────────────┘
```

**알림 트리거**
- 태스크 할당 시
- 마감일 D-3, D-1, 당일
- 댓글 멘션 시
- 선행 태스크 완료 시
- 프로젝트 상태 변경 시

---

### 2.10 멤버 초대 플로우

```
설정 페이지 → "멤버 초대" → 이메일 입력 → 권한 설정 → 초대 발송
```

#### **멤버 초대 모달**
```
┌────────────────────────────────────────┐
│  팀원 초대                          ✕  │
├────────────────────────────────────────┤
│                                        │
│  이메일 주소                           │
│  [dev@example.com____________]         │
│                                        │
│  권한                                  │
│  ◉ 일반 멤버 (편집 가능)               │
│  ○ 관리자 (전체 권한)                  │
│  ○ 뷰어 (읽기 전용)                    │
│                                        │
│  [ 취소 ]              [ 초대 보내기 ] │
└────────────────────────────────────────┘
```

**초대 이메일**
```
제목: [간트차트 플랫폼] ABC Corp 조직에 초대되었습니다

안녕하세요!

김팀장님이 ABC Corp 조직에 회원님을 초대했습니다.

[ 초대 수락하기 ]  ← /invite/accept?token=xxx

감사합니다.
```

**수락 플로우**
1. 수신자가 링크 클릭
2. 계정이 있으면: 로그인 → 조직 가입
3. 계정이 없으면: 회원가입 → 자동 가입

---

## 3. 에러 및 예외 플로우

### 3.1 네트워크 오류
```
사용자 액션 → API 요청 → 타임아웃 (10초) → 에러 토스트 표시 → 재시도 버튼
```

**에러 토스트**
```
┌────────────────────────────────────────┐
│  ⚠️ 연결 오류                          │
│  서버와 연결할 수 없습니다.             │
│  [ 재시도 ]  [ 닫기 ]                  │
└────────────────────────────────────────┘
```

### 3.2 권한 부족
```
뷰어 권한 사용자가 태스크 수정 시도 → 403 에러 → "권한이 없습니다" 모달 표시
```

### 3.3 동시 편집 충돌
```
사용자 A, B가 동시에 같은 태스크 수정 → Last-write-wins → 나중 저장이 반영 → 이전 편집자에게 알림
```

**충돌 알림**
```
┌────────────────────────────────────────┐
│  ⚠️ 변경사항 손실                      │
│  다른 사용자가 이 태스크를 수정했습니다.│
│  최신 정보로 새로고침하시겠습니까?      │
│  [ 취소 ]              [ 새로고침 ]    │
└────────────────────────────────────────┘
```

---

## 4. 모바일 반응형 플로우

### 4.1 모바일 대시보드 (768px 이하)
```
┌──────────────────────┐
│  ☰  간트차트 플랫폼   │
├──────────────────────┤
│                      │
│  [  + 새 프로젝트  ] │
│                      │
│  ┌────────────────┐  │
│  │ 신제품 출시     │  │
│  │ 75% ████░      │  │
│  │ 📅 ~ 03/31     │  │
│  └────────────────┘  │
│                      │
│  ┌────────────────┐  │
│  │ 웹사이트 리뉴얼│  │
│  │ 40% ████░      │  │
│  │ 📅 ~ 02/28     │  │
│  └────────────────┘  │
│                      │
└──────────────────────┘
```

### 4.2 모바일 간트차트
- 세로 모드에서는 리스트 뷰 기본 표시
- 가로 모드 (landscape) 전환 시 간트차트 표시
- 핀치 줌으로 타임라인 확대/축소

---

## 5. 오프라인 플로우 (향후 Phase 2)

```
온라인 → 작업 중 → 오프라인 전환 → 로컬 변경사항 저장 → 온라인 복귀 → 자동 동기화
```

**오프라인 배너**
```
┌────────────────────────────────────────┐
│  ⚠️ 오프라인 모드                      │
│  변경사항은 온라인 복귀 시 동기화됩니다.│
└────────────────────────────────────────┘
```

---

## 6. 키보드 단축키

| 단축키 | 액션 |
|--------|------|
| `N` | 새 태스크 생성 |
| `Shift + N` | 새 프로젝트 생성 |
| `Ctrl/Cmd + K` | 검색 열기 |
| `Esc` | 모달 닫기 |
| `Tab` | 다음 필드로 이동 |
| `Enter` | 저장/확인 |

---

## 7. 성능 고려사항

### 7.1 Skeleton Loading
```
데이터 로딩 중:
┌────────────────────────────────┐
│  ▭▭▭▭▭▭▭▭▭▭▭▭▭▭▭▭▭           │
│  ▭▭▭▭▭▭ ▭▭▭▭                  │
│                                │
│  ▭▭▭▭▭▭▭▭▭▭▭▭▭▭▭▭▭           │
│  ▭▭▭▭▭▭ ▭▭▭▭                  │
└────────────────────────────────┘
```

### 7.2 Infinite Scroll (대량 태스크)
- 초기 로드: 50개 태스크
- 스크롤 하단 도달 시 추가 50개 로드

---

## 8. 접근성 (A11y)

- 모든 인터랙티브 요소에 키보드 포커스 가능
- ARIA 라벨 적용 (스크린 리더 지원)
- 색상 대비율 4.5:1 이상 (WCAG AA)
- 포커스 인디케이터 명확히 표시

---

**문서 버전**: 1.0  
**작성일**: 2026-01-13  
**업데이트**: UI 프로토타입 완성 후 실제 사용자 테스트 결과 반영 예정
